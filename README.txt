# Предисловие

Спасибо, что обратили внимание и решили воспользоваться программой AVR! Она создавалась как способ сведения к минимуму рутинных действий при подготовке документов.

# О программе

## Общее

Программа АВР -- это программа для подготовки документов для открытия заявки на выдачу аварийных ордеров на Портале государственных услуг Московской области.

Программа работает по очень простому принципу: она заменяет строки-шаблоны в документах-образцах на введённые Вами данные. На выходе получается архив готовых документов, которые можно сразу отправить на подпись.

## Техническая сторона

В качестве языка программирования используется VB.NET, а в качестве визуальной составляющей -- WinForms.

Программа предоставляется сразу с образцами, как документов (уже готовых к работе), так и примером организации файловой структуры для работы с программой (включая готовый к использованию файл настроек).

# Работа с программой

## Технические требования

Установка программе не требуется: достаточно переместить всё содержимое архива в одно место. Однако есть критически важные и не такие важные зависимости и условия, соблюдение которых необходимо для корректной работы программы.

### Критически важные требования

Для работы программы необходимы следующие компоненты:

1. Для запуска программы необходима платформа Microsoft .NET Framework версии не ниже 4.7.2. Скачать которую можно [здесь](https://dotnet.microsoft.com/ru-ru/download).
2. Для подготовки документов необходим установленный клиентский пакет MS Office (в частности, MS Office Word), а не Microsoft Office 365. Без него программа не сможет редактировать документы, что делает её использование бессмысленным.
3. Соблюдение определённой структуры организации папки с образцами (папок и файлов в ней).

### Желательные требования

1. Программа по умолчанию использует открытый шрифт Maple Mono Ligatute стиля Regular. Без него, программа будет работать, но шрифт будет использоваться системный. Найти шрифт можно [здесь](https://github.com/subframe7536/maple-font).

## Подготовка к работе

Если все критически важные требования выполнены, можно переходить к подготовке к работе с программой. Она включает два шага: подготовка необходимых папок и файлов, заполнение полей в окне настроек.

### Организация папок и подготовка файлов

Как говорилось выше, программа предоставляется с примером организации файлового пространства для работы. Папки «Открытие» и «Закрытие» -- папки для хранения результатов работы программы, папка «Образцы» -- папка для хранения документов образцов. Первые две могут быть любыми, главное, чтобы они существовали. А вот папка с образцами должна иметь очень чёткую структуру. О ней далее и пойдёт речь.

Перед началом подготовки папки с образцами необходимо ответить на два вопроса:

* Сколько разных людей могут быть ответственны за проведения работ?
* Есть ли организации (службы), уведомление которых требуется лишь иногда?

Только после этого можно начинать. 

Итак, название «корневой» папки с образцами может быть любым. Внутри этой папки должны находится иные папки, **название которых должно** (желательно, но не обязательно) **совпадать с фамилиями людей**, которые могут быть назначены как ответственные за проведение работ. Соответственно, сколько возможных ответственных, столько и должно быть папок.

Далее, внутри каждой папки должны находится следующие документы, необходимые для подачи заявки на Портале: «Гарантийное\_письмо.docx», «Приказ\_Фамилия.docx», «Уведомление\_ЕДДС.docx», «Уведомление\_организаций\_Н.docx». А также служебный файл «Номер\_заявки.txt».
В версии программы 3.2.0.0 и ниже совпадение названий файлов обязательно.

Сами файлы также должны быть названы по особенному (окромя совпадений названий): файлы «Гарантийное\_письмо.docx», «Уведомление\_ЕДДС.docx» и «Номер\_заявки.txt» **должны** иметь такие же названия, как и в предоставляемых образцах. Остальные -- называются по определённому шаблону.

Файл «Приказ\_Фамилия.docx» имеет составное название из обязательной («Приказ\_ .docx») и заполняемой («Фамилия») частей. Вместо «Фамилия» необходимо подставить **название папки, в которой лежит этот файл**. То есть, если папка называется «Иванов» (как в примере), то лежащий в ней файл приказа **должен иметь** название «Приказ\_Иванов.docx» (опять же, как в примере). Соответственно, содержание файла должно подходить по смыслу: В папке «Иванов» файл приказа «Приказ\_Иванов.docx» скорее всего не должен содержать текст приказа на Сидорова.

С файлом «Уведомление\_организаций\_Н.docx» ситуация сложнее: файл с таким названием должен быть в каждой подпапке обязательно (**и именно с таким названием**). Он должен исполнять роль уведомления «по умолчанию»: отправляться на Портал чаще всего. Если ответ на второй вопрос выше -- «Да», то для каждой такой организации необходимо **создать новый файл**, где в конце названия буква «Н» должна быть заменена на **придуманное сокращение** для названия такой организации. В предоставленных примерах это файлы «Уведомление\_организаций\_РК.docx» («Рога и Копыта»), «Уведомление\_организаций\_Р.docx» («Ромашка») и «Уведомление\_организаций\_КЯТ.docx» («Котлованы, ямы и траншеи»). Учтите, что сокращения для **разных** организаций **не должны быть одинаковыми** (как минимум по тому, что в системе не может быть двух файлов с одинаковым названием в одной папке).

По таким правилам необходимо подготовить папки для каждого ответственного. Как вариант подготовки, можно исправить содержимое предоставляемых файлов, как и их название. Однако, **соблюдение условий выше обязательно**.

### Указание шаблонов

Как говорилось выше, программа заменят строки-шаблоны на введённые данные. Поэтому, эти строки шаблоны необходимо подготовить (или взять напрямую из предоставленных документов). Ниже будет перечень шаблонов-примеров с обозначением.

1. «дд»\<месяц\>\<гггг\> -- шаблон для даты подачи документов в формате «12» мая 2020;
2. \<п.дд.мм.гггг\> -- шаблон для даты подачи документов в формате 12.05.2020;
3. \<нр.дд.мм.гггг\> -- шаблон для даты начала проводимых работ в формате 12.05.2020;
4. \<кр.дд.мм.гггг\> -- шаблон для даты окончания проводимых работ в формате 12.05.2020;
5. \<б.дд.мм.гггг\> -- шаблон для даты окончания благоустройства в формате 12.05.2020;
6. \<номер\> -- шаблон для номера телефонограммы в формате 50;
7. \<адрес\> -- шаблон для адреса места проводимых работ;
8. \<вид_работ\> -- шаблон для вида проводимых работ.

При указании шаблонов учитывайте следующие моменты: 
1. Ограничьте текст шаблона какими-нибудь мало встречающимися символами (кроме символов «^»). Например, знаками «больше», «меньше», как в примере.
2. Старайтесь быть краткими в тексте шаблонов;
3. Придерживайтесь правила: «По тексту шаблона должно быть понятно, для чего он».
4. Шаблон и его заменитель идут в тандеме: при расположении шаблонов в тексте учитывайте ещё и то, на что он будет заменён. Например, если шаблон адреса будет заменятся на адрес с указанием города, то и в документе он должен заменить название города.
5. Указать шаблоны необходимо в каждом документе.

### Настройка самой программы

После выполнения условий предыдущего пункта, можно переходить к самой программе. При первом запуске (если файл с настройками не находится там же, где и запускаемая программа) будут применены «настройки по умолчанию», то есть для предоставленных папок и документов. Так что необходимо нажать на кнопку «Настройки» внизу окна программы и указать свои значения.

Во вкладке «Пути» необходимо указать пути к соответствующим папкам (который, как подразумевается, были подготовлены заранее). Это можно сделать напрямую вписав полные пути в соответствующие поля, а можно выбрать с помощью системного окна. Для этого необходимо нажать на кнопку с изображением папки рядом с полем.

Во вкладке «Списки» необходимо указать значения, которые будет отображаться в форме как элементы соответствующих списков. Заполнение идёт в одну строку без пробелов с разделением через точку с запятой между элементами. 

В поле для фамилий необходимо указать названия папок, которые были созданы в пункте «Организация папок и подготовка файлов». То есть итоговая цепочка такова: Папка «Иванов», в ней файл приказа «Приказ\_Иванов.docx»,  и в поле указано «Иванов». И так для каждой папки.

В поле для названий организаций необходимо указать те названия организаций, который Вы хотите чтобы отображались с соответствующем списке. После названия обязательно необходимо указать сокращённое название организации, указанное в пункте «Организация папок и подготовка файлов». Иначе говоря, если файл с уведомление организации «Ромашка» имеет название «Уведомление\_организаций\_Р.docx», то в поле необходимо записать «Ромашка(Р)». И так для каждой организации. Но! **Первым элементом всегда должно быть «Нет(Н)»**, как значение по умолчанию.

В поле для типов работ необходимо указать предполагаемые типы выполняемых работ. Ограничений на название тут нет (кроме смыслового).

Во вкладке «Шаблоны» необходимо указать шаблоны, составленные в пункте «Указание шаблонов».

После изменения полей, отличных от настроек по умолчанию, можно нажимать кнопку «Сохранить настройки». Если всё будет хорошо, они успешно применятся автоматически.

Отдельно стоит отметить, что на каждой вкладке есть кнопка «Справка», которая отобразит краткую справку для каждой вкладки.

## Подготовка документов

После настройки программы, можно, наконец-то, перейти к её главной функции: подготовке документов. Для этого необходимо ввести в поля необходимые значения, выбрать соответствующие элементы из списков, и нажать кнопку «Подготовить документы». Если всё правильно настроено, на выходе в папке, выбранной для «открытия», будет лежать архив с готовыми документами.

Несколько не очевидных моментов:
* Поле «Краткий адрес» используется как название папок и архива с результатами работы программы.
* Формат названия выходных папок следующий: «дата начала работ (дата подачи документов) краткий адрес» -- для папки с готовыми документами («открытия»); «дата начала работ краткий адрес» -- для архива и для папки «закрытие».

Если никаких ошибок не возникло, поздравляю! Вы подготовили первый комплект документов. Надеюсь, что из многих.

# Послесловие

Программа создавалась человеком, который имеет лишь базовые навыки программирования, на новом для него языке программирования. Так что в программе явно есть какие-либо баги, автору неизвестные. Пожалуйста, оставьте баг репорт с описанием проблемы (чем подробнее, тем лучше), чтобы я смог исправить найденное.

Также хочу сказать, что надеюсь, что программа принесёт пользу людям и облегчит кому-то его рутинные задачи. Так как это её главная цель -- убрать элемент рутины и облегчить процесс, чтобы минимизировать объём работы и количество допускаемых ошибок, связанных с перекопированием и изменением одних и тех же данных в разных местах.